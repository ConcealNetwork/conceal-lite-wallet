<div class="loading" *ngIf="getDataService().isLoading">
  <app-loader></app-loader>
</div>

<div *ngIf="!getDataService().isLoading" class="container" fxLayout="column" fxLayoutAlign="space-evenly stretch">

	<div fxLayout="row" fxLayoutGap="45px">

		<div class="content expansion-panel" fxFlex fxLayout="column" fxLayoutAlign="start stretch">
			<div @stagger2>
				<h1 id="title" class="title">{{ 'PAGES.PAY.TITLE' | translate }}</h1>
			</div>

			<mat-accordion>

				<mat-expansion-panel id="panel" [expanded]="step === 0" (opened)="setStep(0)">
					<mat-expansion-panel-header>
						<mat-panel-title>
							<span fxFlex>{{ 'PAGES.PAY.HEADINGS.SENDER' | translate }}</span>
						</mat-panel-title>
					</mat-expansion-panel-header>
					<mat-panel-description>
						<div fxFlex fxLayout="column">
							<div fxFlex fxLayout="row" fxLayoutAlign="space-between center">
								<div fxFlex fxLayout="column" fxFlex="80">
									<div class="heading">Origin</div>
									<div class="subheading">Please select which wallet to send from and the desired amount to PAY.</div>
								</div>
								<div class="balance" fxFlex="30">
									<div class="available">Available Balance</div>
									<div class="amount">
										<span>{{getDataService().balance}}</span>
										<span class="symbol"> CCX</span>
									</div>
								</div>
							</div>
							<div fxFlex fxLayout="row" fxLayoutAlign="start stretch">
								<div class="form-fields" fxFlex="35">
									<mat-form-field fxFlex appearance="fill">
										<mat-label>From Wallet</mat-label>
										<span matPrefix>
											<mat-icon svgIcon="account_balance_wallet"></mat-icon>
										</span>
										<mat-select required [(value)]="getDataService().selectedWallet" (selectionChange)="getHelperService().selectedWallet($event.value)">
											<mat-option [value]="item.key" *ngFor="let item of getDataService().wallets | keyvalue">
												{{ (item.key.length > 7) ? (item.key | slice:0:7) +'...':(item.key) }}{{ (item.key | slice:-7) }}
											</mat-option>
										</mat-select>
									</mat-form-field>
								</div>
								<div class="form-fields" fxFlex="30">
									<mat-form-field fxFlex appearance="fill">
										<mat-label>Amount</mat-label>
										<input matInput required #amount type="number" [value]="getDataService().sendAmount">
										<span matSuffix>CCX</span>
									</mat-form-field>
								</div>
								<div class="buttons" fxFlex="30" fxFlexOffset="5">
									<div fxLayout="row" fxFill fxLayoutGap="10px">
											<button mat-stroked-button aria-hidden="false" aria-label="Add 25% of balance" matTooltip="Add 25% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" (click)="getHelperService().percentageOfBalance(25)">25%</button>
											<button mat-stroked-button aria-hidden="false" aria-label="Add 50% of balance" matTooltip="Add 50% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" (click)="getHelperService().percentageOfBalance(50)">50%</button>
											<button mat-stroked-button aria-hidden="false" aria-label="Add 100% of balance" matTooltip="Add 100% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" (click)="getHelperService().percentageOfBalance(100)">Max</button>
									</div>
								</div>
							</div>
						</div>
					</mat-panel-description>
					<mat-action-row>
						<button class="triggers" mat-button color="primary" (click)="nextStep()">Next</button>
					</mat-action-row>
				</mat-expansion-panel>

				<mat-expansion-panel id="panel" [expanded]="step === 1" (opened)="setStep(1)">
					<mat-expansion-panel-header>
						<mat-panel-title>
							<span fxFlex>{{ 'PAGES.PAY.HEADINGS.RECIPIENT' | translate }}</span>
						</mat-panel-title>
					</mat-expansion-panel-header>
					<mat-panel-description>
						<div fxFlex fxLayout="column">
							<div fxFlex fxLayout="row" fxLayoutAlign="start">
								<div fxFlex="100" fxLayout="column" fxLayoutAlign="start">
									<div class="heading">Destination</div>
									<div class="subheading">Please ensure that the Address and the Payment ID (if included) are correct before sending. Funds sent to the wrong address will be lost.</div>
								</div>
							</div>
							<div fxLayout="row" fxFlex fxLayoutAlign="start stretch" fxLayoutGap="15px">
								<div class="form-fields" fxFlex="80" fxLayout="column" fxLayoutAlign="start" fxLayoutGap="24px">
									<mat-form-field hintLabel="Max 65 characters" appearance="fill">
										<mat-label>Address</mat-label>
										<input matInput required #address type="text" maxlength="65" placeholder="CCX Address">
										<mat-icon class="icon-button" matSuffix svgIcon="contacts" matTooltip="Select from contacts" matTooltipPosition="below" matTooltipClass="custom-tooltip" routerLink="/contacts"></mat-icon>
										<mat-hint align="end">{{address.value.length}} / 65</mat-hint>
									</mat-form-field>
									<mat-form-field hintLabel="Max 35 characters" appearance="fill">
										<mat-label>Payment ID (Optional)</mat-label>
										<input matInput #payid type="text" maxlength="35" placeholder="Payment ID">
										<mat-hint align="end">{{payid.value.length}} / 35</mat-hint>
									</mat-form-field>
								</div>
								<div class="form-fields" fxFlex="40" fxLayout="column" fxLayoutAlign="start" fxLayoutGap="15px">
									<mat-form-field hintLabel="Max 260 characters" appearance="fill">
										<mat-label>Message (Optional)</mat-label>
										<textarea rows="7" matInput #message type="text" maxlength="260" placeholder="Message"></textarea>
										<mat-hint align="end">{{message.value.length}} / 260</mat-hint>
									</mat-form-field>
								</div>
							</div>
						</div>
					</mat-panel-description>
					<mat-action-row>
						<button class="triggers" mat-button color="primary" (click)="prevStep()">Back</button>
					</mat-action-row>
				</mat-expansion-panel>

			</mat-accordion>

		</div>

		<div class="side" fxLayout="column" fxLayoutAlign="center stretch">
			<div fxLayout="row">
				<div class="button-menu" fxLayout="column" @stagger2>
					<button id="button" mat-stroked-button color="warn" aria-hidden="false" aria-label="reset">Cancel</button>
					<button id="button" mat-stroked-button aria-hidden="false" aria-label="reset">Clear</button>
					<button id="button" mat-stroked-button color="primary" aria-hidden="false" aria-label="continue">Send</button>
				</div>
			</div>
		</div>

	</div>

</div>